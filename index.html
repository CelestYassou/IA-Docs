<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>IA Docs</title>
  <link rel="icon" type="image/png" href="IA-Docs-none.png">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&family=Open+Sans:wght@400;700&family=Lato:wght@400;700&family=Montserrat:wght@400;700&family=Playfair+Display:wght@400;700&display=swap" rel="stylesheet">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.3.2/html2canvas.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/interact.js/1.10.11/interact.min.js"></script>
  <style>
    :root {
      --glass: rgba(240, 240, 240, 0.9);
      --aluminium: linear-gradient(145deg, #e0e0e0, #f5f5f5);
      --dark-shadow: 0 4px 6px rgba(0, 0, 0, 0.2);
      --backdrop-filter: blur(8px);
      --border-radius: 12px;
      --light-background: #f0f2f5;
      --dark-background: #121212;
      --light-text: #333;
      --dark-text: #e0e0e0;
    }
    * {
      box-sizing: border-box;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
      background-color: var(--light-background);
      color: var(--light-text);
      display: flex;
    }
    .sidebar {
      width: 200px;
      background: var(--glass);
      backdrop-filter: var(--backdrop-filter);
      -webkit-backdrop-filter: var(--backdrop-filter);
      border-right: 1px solid rgba(0, 0, 0, 0.1);
      height: 100vh;
      position: fixed;
      left: 0;
      top: 0;
      transition: width 0.3s ease;
      box-shadow: var(--dark-shadow);
      overflow: hidden;
      display: flex;
      flex-direction: column;
      border-top-left-radius: var(--border-radius);
      border-bottom-left-radius: var(--border-radius);
    }
    .sidebar.collapsed {
      width: 60px;
    }
    .toggle-sidebar {
      padding: 12px;
      background: var(--aluminium);
      color: var(--light-text);
      text-align: center;
      cursor: pointer;
      border: none;
      font-size: 18px;
      transition: background-color 0.3s;
      border-top-left-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
    }
    .toggle-sidebar:hover {
      background-color: #d0d0d0;
    }
    .page-manager {
      padding: 15px;
      overflow-y: auto;
      flex-grow: 1;
    }
    .page-manager button {
      width: 100%;
      margin-bottom: 15px;
      padding: 10px;
      background: var(--aluminium);
      color: var(--light-text);
      border: none;
      border-radius: var(--border-radius);
      font-weight: bold;
      transition: background-color 0.3s;
    }
    .page-manager button:hover {
      background-color: #d0d0d0;
    }
    .page-list {
      list-style: none;
      padding: 0;
      margin: 0;
    }
    .page-list li {
      background: var(--glass);
      margin-bottom: 8px;
      padding: 10px;
      border-radius: var(--border-radius);
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 14px;
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    .page-list li span {
      flex-grow: 1;
      cursor: pointer;
      margin-left: 10px;
    }
    .page-list button {
      background: none;
      border: none;
      color: #ff5252;
      cursor: pointer;
      font-size: 10px;
      padding: 2px 4px;
      width: auto;
      display: inline-flex;
      align-items: center;
      justify-content: center;
    }
    .page-list button i.fas.fa-trash {
      font-size: 20px;
    }
    .main-content {
      margin-left: 200px;
      width: calc(100% - 200px);
      transition: margin-left 0.3s ease;
    }
    .sidebar.collapsed ~ .main-content {
      margin-left: 60px;
      width: calc(100% - 60px);
    }
    .menu-bar {
      background: var(--glass);
      color: var(--light-text);
      padding: 12px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-weight: 500;
      backdrop-filter: var(--backdrop-filter);
      -webkit-backdrop-filter: var(--backdrop-filter);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: var(--border-radius);
      margin: 10px;
      position: relative;
      z-index: 100;
    }
    .menu-items {
      display: flex;
      gap: 10px;
    }
    .menu-item {
      position: relative;
      padding: 6px 12px;
      cursor: pointer;
      border-radius: var(--border-radius);
      transition: background-color 0.2s;
    }
    .menu-item:hover {
      background: rgba(0, 0, 0, 0.05);
    }
    .dropdown-menu {
      position: absolute;
      background: var(--glass);
      color: var(--light-text);
      min-width: 180px;
      top: 100%;
      left: 0;
      border-radius: var(--border-radius);
      box-shadow: var(--dark-shadow);
      z-index: 200;
      display: none;
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    .dropdown-menu a {
      display: block;
      padding: 12px 16px;
      text-decoration: none;
      color: var(--light-text);
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      cursor: pointer;
    }
    .dropdown-menu a:hover {
      background: rgba(0, 0, 0, 0.05);
    }
    .toolbar {
      background: var(--glass);
      padding: 10px 15px;
      display: flex;
      flex-wrap: wrap;
      gap: 6px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
      backdrop-filter: var(--backdrop-filter);
      -webkit-backdrop-filter: var(--backdrop-filter);
      border-radius: var(--border-radius);
      margin: 10px;
    }
    .toolbar button {
      background: none;
      border: none;
      color: var(--light-text);
      font-size: 16px;
      cursor: pointer;
      padding: 8px;
      border-radius: var(--border-radius);
      transition: background 0.2s;
    }
    .toolbar button:hover {
      background: rgba(0, 0, 0, 0.05);
    }
    .toolbar select,
    .toolbar input[type="color"] {
      padding: 6px 8px;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: var(--border-radius);
      font-size: 14px;
      background: var(--glass);
      color: var(--light-text);
    }
    .color-palette {
      display: flex;
      align-items: center;
      gap: 4px;
    }
    .color-option {
      width: 20px;
      height: 20px;
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: 50%;
      cursor: pointer;
    }
    .document {
      background: var(--glass);
      margin: 20px auto;
      border-radius: var(--border-radius);
      max-width: 900px;
      box-shadow: var(--dark-shadow);
      border: 1px solid rgba(0, 0, 0, 0.1);
    }
    .document-header {
      padding: 16px 20px;
      border-bottom: 1px solid rgba(0, 0, 0, 0.1);
    }
    .document-title input {
      width: 100%;
      font-size: 20px;
      font-weight: bold;
      border: none;
      outline: none;
      background: none;
      color: var(--light-text);
    }
    .document-content {
      padding: 20px;
    }
    .document-content [contenteditable="true"] {
      min-height: 400px;
      outline: none;
      font-size: 16px;
      line-height: 1.7;
      color: var(--light-text);
    }
    .document-content [contenteditable="true"]:empty:before {
      content: attr(placeholder);
      color: #aaa;
    }
    .document-footer {
      text-align: center;
      font-size: 12px;
      padding: 10px;
      border-top: 1px solid rgba(0, 0, 0, 0.1);
      color: #888;
    }
    .chatgpt-button {
      background: var(--aluminium);
      color: var(--light-text);
      padding: 8px 14px;
      border: none;
      border-radius: var(--border-radius);
      font-weight: bold;
      cursor: pointer;
      margin-left: 8px;
      transition: background 0.2s;
    }
    .chatgpt-button:hover {
      background-color: #d0d0d0;
    }
    #wordCount {
      margin-left: auto;
      font-size: 14px;
      color: var(--light-text);
    }
    .recording {
      background-color: #ff5252 !important;
      color: white;
      border-radius: var(--border-radius);
    }
    .dark-mode {
      background-color: var(--dark-background);
      color: var(--dark-text);
    }
    .dark-mode .sidebar {
      background-color: rgba(50, 50, 50, 0.9);
    }
    .dark-mode .toggle-sidebar {
      background-color: #e0e0e0;
      color: black;
    }
    .dark-mode .page-manager button {
      background-color: #e0e0e0;
      color: black;
    }
    .dark-mode .page-manager button:hover {
      background-color: #d0d0d0;
    }
    .dark-mode .page-list li {
      background-color: rgba(70, 70, 70, 0.9);
      color: var(--dark-text);
    }
    .dark-mode .page-list button {
      color: #ff7777;
    }
    .dark-mode .toolbar,
    .dark-mode .menu-bar {
      background-color: rgba(70, 70, 70, 0.9);
      color: var(--dark-text);
    }
    .dark-mode .toolbar button i {
      color: white;
    }
    .dark-mode .page-manager button i,
    .dark-mode .toggle-sidebar i {
      color: black;
    }
    .dark-mode select,
    .dark-mode input[type="color"] {
      background-color: rgba(70, 70, 70, 0.9);
      color: var(--dark-text);
      border: 1px solid #666;
    }
    .dark-mode .dropdown-menu {
      background-color: rgba(70, 70, 70, 0.9);
      color: var(--dark-text);
      border: 1px solid #666;
    }
    .dark-mode .dropdown-menu a {
      color: var(--dark-text);
    }
    .dark-mode .dropdown-menu a:hover {
      background-color: rgba(90, 90, 90, 0.9);
    }
    .dark-mode .toolbar button:hover {
      background-color: rgba(90, 90, 90, 0.9);
    }
    .dark-mode .document {
      background-color: rgba(70, 70, 70, 0.9);
      color: var(--dark-text);
    }
    .dark-mode .document-title input {
      color: var(--dark-text);
    }
    .dark-mode .color-option {
      border: 1px solid #666;
    }
    .dark-mode .document-content [contenteditable="true"] {
      color: var(--dark-text);
    }
    .dark-mode #wordCount {
      color: var(--dark-text);
    }
    .icon-wrapper {
      position: relative;
      display: inline-block;
      font-size: 20px;
    }
    .icon-wrapper .fa-file-alt {
      color: #555;
    }
    .icon-wrapper .fa-star {
      position: absolute;
      top: -6px;
      right: -6px;
      font-size: 12px;
      background: linear-gradient(5deg, #ff0080, #0066ff, #00cc66);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-fill-color: transparent;
    }
    #fileInput, #imageInput {
      display: none;
    }
    .resizable-image {
      position: relative;
      display: inline-block;
      max-width: 100%;
      margin: 10px 0;
    }
    .resizable-image img {
      max-width: 100%;
      height: auto;
    }
    .resize-handle {
      position: absolute;
      width: 10px;
      height: 10px;
      background: #4a6fa5;
      right: 0;
      bottom: 0;
      cursor: nwse-resize;
    }
    .highlight {
      background-color: yellow;
    }
    .note {
      position: absolute;
      width: 200px;
      background: var(--glass);
      border: 1px solid rgba(0, 0, 0, 0.1);
      border-radius: var(--border-radius);
      box-shadow: var(--dark-shadow);
      z-index: 100;
      display: none;
    }
    .note-header {
      background: var(--aluminium);
      color: var(--light-text);
      padding: 8px;
      cursor: move;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-top-left-radius: var(--border-radius);
      border-top-right-radius: var(--border-radius);
    }
    .note-content {
      padding: 10px;
    }
    .note-content textarea {
      width: 100%;
      border: none;
      resize: none;
      outline: none;
      background: none;
      color: var(--light-text);
    }
    .close-note {
      background: none;
      border: none;
      color: var(--light-text);
      cursor: pointer;
      font-size: 16px;
    }
    .note-indicator {
      position: relative;
    }
    .note-indicator::after {
      content: '';
      position: absolute;
      top: -5px;
      right: -5px;
      width: 10px;
      height: 10px;
      background-color: red;
      border-radius: 50%;
      display: none;
    }
    .has-content::after {
      display: block;
    }
    .note-resize-handle {
      position: absolute;
      width: 10px;
      height: 10px;
      background: #4a6fa5;
      right: 0;
      bottom: 0;
      cursor: nwse-resize;
    }
    .dark-mode .note {
      background-color: rgba(70, 70, 70, 0.9);
      border: 1px solid #666;
      color: var(--dark-text);
    }
    .dark-mode .note-header {
      background-color: #e0e0e0;
    }
    .dark-mode .note-header i {
      color: black;
    }
    .dark-mode .note-content textarea {
      background-color: rgba(70, 70, 70, 0.9);
      color: var(--dark-text);
    }
    .sidebar.collapsed .page-list li span {
      display: none;
    }
    .sidebar.collapsed .page-list li {
      justify-content: center;
    }
    .sidebar.collapsed .page-list button {
      display: none;
    }
    .chatgpt-loader {
      --uib-size: 45px;
      --uib-color: black;
      --uib-speed: 1.75s;
      position: relative;
      height: var(--uib-size);
      width: var(--uib-size);
      animation: rotate calc(var(--uib-speed) * 4) linear infinite;
      cursor: pointer;
    }
    .dark-mode .chatgpt-loader {
      --uib-color: white;
    }
    @keyframes rotate {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }
    .particle {
      position: absolute;
      top: 0%;
      left: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      width: 100%;
    }
    .particle::before {
      content: '';
      position: absolute;
      height: 17.5%;
      width: 17.5%;
      border-radius: 50%;
      background-color: var(--uib-color);
      flex-shrink: 0;
      transition: background-color 0.3s ease;
      animation: orbit var(--uib-speed) linear calc(var(--uib-delay) * var(--uib-speed)) infinite;
    }
    @keyframes orbit {
      0% {
        transform: translate(calc(var(--uib-size) * 0.5)) scale(0.73684);
        opacity: 0.65;
      }
      5% {
        transform: translate(calc(var(--uib-size) * 0.4)) scale(0.684208);
        opacity: 0.58;
      }
      10% {
        transform: translate(calc(var(--uib-size) * 0.3)) scale(0.631576);
        opacity: 0.51;
      }
      15% {
        transform: translate(calc(var(--uib-size) * 0.2)) scale(0.578944);
        opacity: 0.44;
      }
      20% {
        transform: translate(calc(var(--uib-size) * 0.1)) scale(0.526312);
        opacity: 0.37;
      }
      25% {
        transform: translate(0%) scale(0.47368);
        opacity: 0.3;
      }
      30% {
        transform: translate(calc(var(--uib-size) * -0.1)) scale(0.526312);
        opacity: 0.37;
      }
      35% {
        transform: translate(calc(var(--uib-size) * -0.2)) scale(0.578944);
        opacity: 0.44;
      }
      40% {
        transform: translate(calc(var(--uib-size) * -0.3)) scale(0.631576);
        opacity: 0.51;
      }
      45% {
        transform: translate(calc(var(--uib-size) * -0.4)) scale(0.684208);
        opacity: 0.58;
      }
      50% {
        transform: translate(calc(var(--uib-size) * -0.5)) scale(0.73684);
        opacity: 0.65;
      }
      55% {
        transform: translate(calc(var(--uib-size) * -0.4)) scale(0.789472);
        opacity: 0.72;
      }
      60% {
        transform: translate(calc(var(--uib-size) * -0.3)) scale(0.842104);
        opacity: 0.79;
      }
      65% {
        transform: translate(calc(var(--uib-size) * -0.2)) scale(0.894736);
        opacity: 0.86;
      }
      70% {
        transform: translate(calc(var(--uib-size) * -0.1)) scale(0.947368);
        opacity: 0.93;
      }
      75% {
        transform: translate(0%) scale(1);
        opacity: 1;
      }
      80% {
        transform: translate(calc(var(--uib-size) * 0.1)) scale(0.947368);
        opacity: 0.93;
      }
      85% {
        transform: translate(calc(var(--uib-size) * 0.2)) scale(0.894736);
        opacity: 0.86;
      }
      90% {
        transform: translate(calc(var(--uib-size) * 0.3)) scale(0.842104);
        opacity: 0.79;
      }
      95% {
        transform: translate(calc(var(--uib-size) * 0.4)) scale(0.789472);
        opacity: 0.72;
      }
      100% {
        transform: translate(calc(var(--uib-size) * 0.5)) scale(0.73684);
        opacity: 0.65;
      }
    }
    .particle:nth-child(1) {
      --uib-delay: 0;
      transform: rotate(8deg);
    }
    .particle:nth-child(2) {
      --uib-delay: -0.4;
      transform: rotate(36deg);
    }
    .particle:nth-child(3) {
      --uib-delay: -0.9;
      transform: rotate(72deg);
    }
    .particle:nth-child(4) {
      --uib-delay: -0.5;
      transform: rotate(90deg);
    }
    .particle:nth-child(5) {
      --uib-delay: -0.3;
      transform: rotate(144deg);
    }
    .particle:nth-child(6) {
      --uib-delay: -0.2;
      transform: rotate(180deg);
    }
    .particle:nth-child(7) {
      --uib-delay: -0.6;
      transform: rotate(216deg);
    }
    .particle:nth-child(8) {
      --uib-delay: -0.7;
      transform: rotate(252deg);
    }
    .particle:nth-child(9) {
      --uib-delay: -0.1;
      transform: rotate(300deg);
    }
    .particle:nth-child(10) {
      --uib-delay: -0.8;
      transform: rotate(324deg);
    }
    .particle:nth-child(11) {
      --uib-delay: -1.2;
      transform: rotate(335deg);
    }
    .particle:nth-child(12) {
      --uib-delay: -0.5;
      transform: rotate(290deg);
    }
    .particle:nth-child(13) {
      --uib-delay: -0.2;
      transform: rotate(240deg);
    }
  </style>
</head>
<body>
  <div class="sidebar" id="sidebar">
    <button class="toggle-sidebar" onclick="toggleSidebar()"><i class="fas fa-bars"></i></button>
    <div class="page-manager">
      <button onclick="createNewPage()"><i class="fas fa-plus"></i></button>
      <button class="note-indicator" id="noteButton" onclick="toggleNote()"><i class="fas fa-sticky-note"></i></button>
      <ul class="page-list" id="pageList"></ul>
    </div>
  </div>
  <div class="main-content">
    <div class="menu-bar">
      <div class="menu-items">
        <div class="menu-item" onclick="toggleDropdown('file-dropdown')">Fichier
          <div class="dropdown-menu" id="file-dropdown">
            <a onclick="createNewFile()">Nouveau Fichier</a>
            <a onclick="exportToPDF()">Exporter en PDF</a>
            <a onclick="exportToPNG()">Exporter en PNG</a>
            <a onclick="exportToJPEG()">Exporter en JPEG</a>
            <a onclick="exportToRaw()">Exporter en Raw</a>
            <a onclick="exportToJSON()">Exporter en JSON</a>
            <a onclick="document.getElementById('fileInput').click()">Importer depuis JSON</a>
          </div>
        </div>
        <div class="menu-item" onclick="toggleDropdown('edit-dropdown')">Édition
          <div class="dropdown-menu" id="edit-dropdown">
            <a onclick="execCmd('undo')">Annuler</a>
            <a onclick="execCmd('redo')">Rétablir</a>
            <a onclick="execCmd('cut')">Couper</a>
            <a onclick="execCmd('copy')">Copier</a>
            <a onclick="execCmd('paste')">Coller</a>
            <a onclick="execCmd('selectAll')">Sélectionner tout</a>
          </div>
        </div>
        <div class="menu-item" onclick="toggleDropdown('view-dropdown')">Affichage
          <div class="dropdown-menu" id="view-dropdown">
            <a onclick="toggleDarkMode()">Mode sombre</a>
            <a onclick="toggleSidebar()">Barre latérale</a>
          </div>
        </div>
        <div class="menu-item" onclick="toggleDropdown('insert-dropdown')">Insertion
          <div class="dropdown-menu" id="insert-dropdown">
            <a onclick="document.getElementById('imageInput').click()">Image</a>
            <a onclick="execCmd('createLink', prompt('Entrez l\'URL:', 'http://'))">Lien</a>
            <a onclick="execCmd('insertUnorderedList')">Liste à puces</a>
            <a onclick="execCmd('insertOrderedList')">Liste numérotée</a>
          </div>
        </div>
        <div class="menu-item" onclick="toggleDropdown('format-dropdown')">Format
          <div class="dropdown-menu" id="format-dropdown">
            <a onclick="execCmd('bold')">Gras</a>
            <a onclick="execCmd('italic')">Italique</a>
            <a onclick="execCmd('underline')">Souligné</a>
            <a onclick="execCmd('strikeThrough')">Barré</a>
            <a onclick="execCmd('justifyLeft')">Aligner à gauche</a>
            <a onclick="execCmd('justifyCenter')">Centrer</a>
            <a onclick="execCmd('justifyRight')">Aligner à droite</a>
            <a onclick="execCmd('justifyFull')">Justifier</a>
          </div>
        </div>
        <div class="menu-item" onclick="toggleDropdown('help-dropdown')">Aide
          <div class="dropdown-menu" id="help-dropdown">
            <a onclick="alert('Aide - Documentation')">Documentation</a>
            <a onclick="alert('Aide - À propos')">À propos</a>
          </div>
        </div>
      </div>
      <div class="chatgpt-loader" onclick="redirectToChatGPT()">
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
        <div class="particle"></div>
      </div>
    </div>
    <div class="toolbar">
      <button onclick="execCmd('undo')" title="Annuler"><i class="fas fa-undo"></i></button>
      <button onclick="execCmd('redo')" title="Rétablir"><i class="fas fa-redo"></i></button>
      <select onchange="execCmd('formatBlock', this.value)">
        <option value="p">Normal</option>
        <option value="h1">Titre 1</option>
        <option value="h2">Titre 2</option>
        <option value="h3">Titre 3</option>
      </select>
      <select id="fontName" onchange="execCmd('fontName', this.value)">
        <option value="Arial">Arial</option>
        <option value="Times New Roman">Times New Roman</option>
        <option value="Courier New">Courier New</option>
        <option value="Roboto">Roboto</option>
        <option value="Open Sans">Open Sans</option>
        <option value="Lato">Lato</option>
        <option value="Montserrat">Montserrat</option>
        <option value="Playfair Display">Playfair Display</option>
        <option value="Georgia">Georgia</option>
        <option value="Verdana">Verdana</option>
        <option value="Helvetica">Helvetica</option>
      </select>
      <select id="fontSize" onchange="execCmd('fontSize', this.value)">
        <option value="1">8</option>
        <option value="2">10</option>
        <option value="3">11</option>
        <option value="4">12</option>
        <option value="5">14</option>
        <option value="6">16</option>
        <option value="7">18</option>
        <option value="8">20</option>
        <option value="9">22</option>
        <option value="10">24</option>
        <option value="11">28</option>
        <option value="12">32</option>
        <option value="13">36</option>
        <option value="14">48</option>
      </select>
      <button onclick="execCmd('bold')" title="Gras"><i class="fas fa-bold"></i></button>
      <button onclick="execCmd('italic')" title="Italique"><i class="fas fa-italic"></i></button>
      <button onclick="execCmd('underline')" title="Souligné"><i class="fas fa-underline"></i></button>
      <button onclick="execCmd('strikeThrough')" title="Barré"><i class="fas fa-strikethrough"></i></button>
      <div class="color-palette">
        <div class="color-option" style="background-color: #FFFF00;" onclick="applyHighlight('#FFFF00')"></div>
        <div class="color-option" style="background-color: #FF9999;" onclick="applyHighlight('#FF9999')"></div>
        <div class="color-option" style="background-color: #99FF99;" onclick="applyHighlight('#99FF99')"></div>
        <div class="color-option" style="background-color: #99FFFF;" onclick="applyHighlight('#99FFFF')"></div>
        <div class="color-option" style="background-color: #FF99FF;" onclick="applyHighlight('#FF99FF')"></div>
      </div>
      <input type="color" id="highlightColor" onchange="applyHighlight(this.value)" title="Choisir une couleur de surlignage">
      <button onclick="execCmd('createLink', prompt('Entrez l\'URL:', 'http://'))" title="Lien"><i class="fas fa-link"></i></button>
      <button onclick="document.getElementById('imageInput').click()" title="Insérer une image"><i class="fas fa-image"></i></button>
      <button onclick="execCmd('insertUnorderedList')" title="Liste"><i class="fas fa-list-ul"></i></button>
      <button onclick="execCmd('insertOrderedList')" title="Liste numérotée"><i class="fas fa-list-ol"></i></button>
      <button onclick="execCmd('justifyLeft')" title="Gauche"><i class="fas fa-align-left"></i></button>
      <button onclick="execCmd('justifyCenter')" title="Centré"><i class="fas fa-align-center"></i></button>
      <button onclick="execCmd('justifyRight')" title="Droite"><i class="fas fa-align-right"></i></button>
      <button onclick="execCmd('justifyFull')" title="Justifié"><i class="fas fa-align-justify"></i></button>
      <button onclick="execCmd('outdent')" title="Diminuer le retrait"><i class="fas fa-outdent"></i></button>
      <button onclick="execCmd('indent')" title="Augmenter le retrait"><i class="fas fa-indent"></i></button>
      <button onclick="execCmd('removeFormat')" title="Effacer format"><i class="fas fa-eraser"></i></button>
      <button onclick="toggleDarkMode()" title="Mode sombre"><i class="fas fa-moon"></i></button>
      <button id="recordButton" onclick="toggleRecording()" title="Enregistrement vocal"><i class="fas fa-microphone"></i></button>
      <button class="chatgpt-button" onclick="createMindMap()">
        <span class="icon-wrapper"><i class="fas fa-project-diagram"></i><i class="fas fa-star"></i></span>
      </button>
      <button class="chatgpt-button" onclick="redirectToChatGPT()">
        <span class="icon-wrapper"><i class="fas fa-file-alt"></i><i class="fas fa-star"></i></span>
      </button>
      <span id="wordCount">Mots : 0</span>
    </div>
    <div class="document">
      <div class="document-header">
        <div class="document-title">
          <input type="text" id="doc-title" placeholder="Document sans titre">
        </div>
      </div>
      <div class="document-content">
        <div id="editor" contenteditable="true" placeholder="Commencez à écrire ici..."></div>
      </div>
      <div class="document-footer">
        <p>&copy; Tous droits réservé à CelestYassou - <a href="https://celestyassou.github.io/IA-Docs/Politique-de-confidentialit%C3%A9-et-politique-d-utilisation-g%C3%A9n%C3%A9rale-IA-Docs.html">Politiques de confidentialité et d'utilisation</a></p>
      </div>
    </div>
    <div class="note" id="note">
      <div class="note-header" onmousedown="startDrag(event)">
        <span>Note</span>
        <button class="close-note" onclick="closeNote()"><i class="fas fa-times"></i></button>
      </div>
      <div class="note-content">
        <textarea id="note-content" placeholder="Écrivez votre note ici..."></textarea>
      </div>
      <div class="note-resize-handle"></div>
    </div>
  </div>
  <input type="file" id="fileInput" accept=".json" />
  <input type="file" id="imageInput" accept="image/*" />
  <script>
    let recognition;
    let isRecording = false;
    let currentPageId = null;
    let isDragging = false;
    let offsetX, offsetY;

    function toggleSidebar() {
      const sidebar = document.getElementById('sidebar');
      sidebar.classList.toggle('collapsed');
    }

    function toggleDropdown(id) {
      const dropdown = document.getElementById(id);
      const allDropdowns = document.querySelectorAll('.dropdown-menu');
      allDropdowns.forEach(dropdown => {
        if (dropdown.id !== id) {
          dropdown.style.display = 'none';
        }
      });
      dropdown.style.display = dropdown.style.display === 'block' ? 'none' : 'block';
    }

    function closeAllDropdowns() {
      const allDropdowns = document.querySelectorAll('.dropdown-menu');
      allDropdowns.forEach(dropdown => {
        dropdown.style.display = 'none';
      });
    }

    document.addEventListener('click', function(event) {
      if (!event.target.matches('.menu-item')) {
        closeAllDropdowns();
      }
    });

    function applyHighlight(color) {
      const selection = window.getSelection();
      if (selection.rangeCount > 0) {
        const range = selection.getRangeAt(0);
        const span = document.createElement('span');
        span.style.backgroundColor = color;
        span.className = 'highlight';
        range.surroundContents(span);
      }
    }

    function execCmd(command, value = null) {
      document.execCommand(command, false, value);
      document.getElementById('editor').focus();
    }

    function saveToLocalStorage() {
      const content = document.getElementById('editor').innerHTML;
      const title = document.getElementById('doc-title').value;
      const pageData = { title, content };
      if (currentPageId) {
        localStorage.setItem(`page_${currentPageId}`, JSON.stringify(pageData));
      }
    }

    function loadFromLocalStorage(pageId) {
      const saved = localStorage.getItem(`page_${pageId}`);
      if (saved) {
        const pageData = JSON.parse(saved);
        document.getElementById('doc-title').value = pageData.title;
        document.getElementById('editor').innerHTML = pageData.content;
        currentPageId = pageId;
        makeImagesResizable();
      }
    }

    function createNewPage() {
      currentPageId = Date.now();
      document.getElementById('doc-title').value = `Page ${new Date(currentPageId).toLocaleString()}`;
      document.getElementById('editor').innerHTML = '';
      saveToLocalStorage();
      updatePageList();
      loadFromLocalStorage(currentPageId);
    }

    function createNewFile() {
      if (confirm("Voulez-vous vraiment créer un nouveau fichier ? Cela effacera le contenu actuel.")) {
        document.getElementById('doc-title').value = '';
        document.getElementById('editor').innerHTML = '';
        currentPageId = null;
      }
    }

    function toggleNote() {
      const note = document.getElementById('note');
      if (note.style.display === 'block') {
        closeNote();
      } else {
        note.style.display = 'block';
        note.style.left = '50%';
        note.style.top = '50%';
        loadNote();
        makeNoteResizable();
      }
    }

    function closeNote() {
      const note = document.getElementById('note');
      note.style.display = 'none';
      saveNote();
    }

    function saveNote() {
      const noteContent = document.getElementById('note-content').value;
      localStorage.setItem('noteContent', noteContent);
      updateNoteIndicator();
    }

    function loadNote() {
      const savedNote = localStorage.getItem('noteContent');
      if (savedNote) {
        document.getElementById('note-content').value = savedNote;
      }
      updateNoteIndicator();
    }

    function updateNoteIndicator() {
      const noteContent = localStorage.getItem('noteContent');
      const noteButton = document.getElementById('noteButton');
      if (noteContent && noteContent.trim() !== '') {
        noteButton.classList.add('has-content');
      } else {
        noteButton.classList.remove('has-content');
      }
    }

    function makeNoteResizable() {
      interact('#note').resizable({
        edges: { right: true, bottom: true, left: false, top: false },
        listeners: {
          move: function (event) {
            let target = event.target;
            target.style.width = event.rect.width + 'px';
            target.style.height = event.rect.height + 'px';
          }
        },
        modifiers: [
          interact.modifiers.restrictSize({
            min: { width: 150, height: 100 }
          })
        ],
        inertia: true
      }).draggable({
        listeners: {
          move: dragMoveListener
        },
        inertia: true
      });
    }

    function startDrag(e) {
      isDragging = true;
      const note = document.getElementById('note');
      offsetX = e.clientX - note.getBoundingClientRect().left;
      offsetY = e.clientY - note.getBoundingClientRect().top;
      document.addEventListener('mousemove', drag);
      document.addEventListener('mouseup', stopDrag);
    }

    function drag(e) {
      if (isDragging) {
        const note = document.getElementById('note');
        note.style.left = (e.clientX - offsetX) + 'px';
        note.style.top = (e.clientY - offsetY) + 'px';
      }
    }

    function stopDrag() {
      isDragging = false;
      document.removeEventListener('mousemove', drag);
    }

    function dragMoveListener(event) {
      const target = event.target;
      const x = (parseFloat(target.getAttribute('data-x')) || 0) + event.dx;
      const y = (parseFloat(target.getAttribute('data-y')) || 0) + event.dy;
      target.style.transform = 'translate(' + x + 'px, ' + y + 'px)';
      target.setAttribute('data-x', x);
      target.setAttribute('data-y', y);
    }

    function createMindMap() {
      const text = document.getElementById("editor").innerText || "";
      const prompt = `Crée une carte mentale basée sur le texte suivant : ${text}`;
      const mindMapUrl = `https://chat.openai.com/?prompt=${encodeURIComponent(prompt)}`;
      window.open(mindMapUrl, '_blank');
    }

    function updatePageList() {
      const pageList = document.getElementById('pageList');
      pageList.innerHTML = '';
      for (let i = 0; i < localStorage.length; i++) {
        const key = localStorage.key(i);
        if (key.startsWith('page_')) {
          const pageId = key.replace('page_', '');
          const pageData = JSON.parse(localStorage.getItem(key));
          const li = document.createElement('li');
          li.innerHTML = `
            <div style="display: flex; justify-content: center; align-items: center; width: 100%;">
              <i class="fas fa-file-alt"></i>
              <span onclick="loadFromLocalStorage('${pageId}')" style="flex-grow: 1; text-align: center;">${pageData.title || 'Sans titre'}</span>
              <button onclick="deletePage('${pageId}')" style="margin-left: auto;"><i class="fas fa-trash"></i></button>
            </div>
          `;
          pageList.appendChild(li);
        }
      }
    }

    function deletePage(pageId) {
      localStorage.removeItem(`page_${pageId}`);
      if (currentPageId === pageId) {
        document.getElementById('doc-title').value = '';
        document.getElementById('editor').innerHTML = '';
        currentPageId = null;
      }
      updatePageList();
    }

    function prepareForExport() {
      const editor = document.getElementById('editor');
      const originalContent = editor.innerHTML;
      editor.style.backgroundColor = 'white';
      editor.style.color = 'black';
      const spans = editor.querySelectorAll('span.highlight');
      spans.forEach(span => {
        span.style.color = 'black';
      });
      return originalContent;
    }

    function restoreAfterExport(originalContent) {
      const editor = document.getElementById('editor');
      editor.innerHTML = originalContent;
    }

    function exportToPDF() {
      const originalContent = prepareForExport();
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF();
      const title = document.getElementById('doc-title').value || 'Document';
      doc.html(document.getElementById('editor'), {
        callback: function (doc) {
          doc.save(`${title}.pdf`);
          restoreAfterExport(originalContent);
        },
        margin: [10, 10, 10, 10],
        autoPaging: 'text',
        x: 0,
        y: 0,
        width: 190,
        windowWidth: 675
      });
    }

    function exportToPNG() {
      const originalContent = prepareForExport();
      const title = document.getElementById('doc-title').value || 'document';
      html2canvas(document.getElementById('editor')).then(canvas => {
        canvas.toBlob(function(blob) {
          saveAs(blob, `${title}.png`);
          restoreAfterExport(originalContent);
        });
      });
    }

    function exportToJPEG() {
      const originalContent = prepareForExport();
      const title = document.getElementById('doc-title').value || 'document';
      html2canvas(document.getElementById('editor')).then(canvas => {
        canvas.toBlob(function(blob) {
          saveAs(blob, `${title}.jpeg`);
          restoreAfterExport(originalContent);
        }, 'image/jpeg');
      });
    }

    function exportToRaw() {
      const title = document.getElementById('doc-title').value || 'document';
      const content = document.getElementById('editor').innerText;
      const blob = new Blob([content], { type: 'text/plain' });
      saveAs(blob, `${title}.txt`);
    }

    function exportToJSON() {
      const title = document.getElementById('doc-title').value || 'document';
      const content = document.getElementById('editor').innerHTML;
      const pageData = { title, content };
      const jsonData = JSON.stringify(pageData, null, 2);
      const blob = new Blob([jsonData], { type: 'application/json' });
      saveAs(blob, `${title}.json`);
    }

    function importFromJSON(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const content = e.target.result;
          const data = JSON.parse(content);
          document.getElementById('doc-title').value = data.title;
          document.getElementById('editor').innerHTML = data.content;
          makeImagesResizable();
        };
        reader.readAsText(file);
      }
    }

    function insertImageFromFile(event) {
      const file = event.target.files[0];
      if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
          const img = document.createElement('img');
          img.src = e.target.result;
          img.style.maxWidth = '100%';
          img.style.height = 'auto';
          const resizableDiv = document.createElement('div');
          resizableDiv.className = 'resizable-image';
          resizableDiv.appendChild(img);
          const resizeHandle = document.createElement('div');
          resizeHandle.className = 'resize-handle';
          resizableDiv.appendChild(resizeHandle);
          document.getElementById('editor').appendChild(resizableDiv);
          makeImagesResizable();
        };
        reader.readAsDataURL(file);
      }
    }

    function makeImagesResizable() {
      interact('.resizable-image').resizable({
        edges: { right: true, bottom: true, left: false, top: false },
        listeners: {
          move: function (event) {
            let target = event.target;
            target.style.width = event.rect.width + 'px';
            target.style.height = event.rect.height + 'px';
          }
        },
        modifiers: [
          interact.modifiers.restrictSize({
            min: { width: 50, height: 50 }
          })
        ],
        inertia: true
      }).draggable({
        listeners: {
          move: dragMoveListener
        },
        inertia: true
      });
    }

    function updateWordCount() {
      const text = document.getElementById("editor").innerText || "";
      const words = text.trim().split(/\s+/).filter(w => w.length > 0).length;
      const chars = text.length;
      document.getElementById("wordCount").textContent = `Mots : ${words} | Caractères : ${chars}`;
    }

    function toggleDarkMode() {
      document.body.classList.toggle("dark-mode");
      const note = document.getElementById('note');
      if (document.body.classList.contains("dark-mode")) {
        note.classList.add("dark-mode");
      } else {
        note.classList.remove("dark-mode");
      }
    }

    function toggleRecording() {
      const recordButton = document.getElementById('recordButton');
      if (!isRecording) {
        recognition = new (window.SpeechRecognition || window.webkitSpeechRecognition)();
        recognition.lang = 'fr-FR';
        recognition.interimResults = false;
        recognition.onresult = function(event) {
          const transcript = event.results[event.results.length - 1][0].transcript;
          document.getElementById('editor').innerHTML += transcript + ' ';
          saveToLocalStorage();
        };
        recognition.onend = function() {
          isRecording = false;
          recordButton.classList.remove('recording');
        };
        recognition.start();
        isRecording = true;
        recordButton.classList.add('recording');
      } else {
        recognition.stop();
        isRecording = false;
        recordButton.classList.remove('recording');
      }
    }

    function redirectToChatGPT() {
      window.open('https://chat.openai.com/', '_blank');
    }

    document.getElementById('fileInput').addEventListener('change', importFromJSON);
    document.getElementById('imageInput').addEventListener('change', insertImageFromFile);
    document.getElementById('note-content').addEventListener('input', saveNote);
    document.getElementById("editor").addEventListener("input", function() {
      updateWordCount();
      saveToLocalStorage();
    });
    document.addEventListener("DOMContentLoaded", () => {
      updatePageList();
      updateWordCount();
      loadNote();
    });
  </script>
</body>
</html>

